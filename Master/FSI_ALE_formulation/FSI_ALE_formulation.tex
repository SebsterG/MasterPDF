\chapter{Fluid Structure Interaction Problem}
In FSI the computing domain is split into three parts. Fluid, structure and interface. The Navier-Stokes equations are solved on the fluid domain and the structure equation on the structure. The interface is where the solid and fluid meet, and FSI is generally solved using two methods. These two main methods differ in their treatment of the interface \cite{Liu2014}. The first uses a fixed mesh, known as Eulerian, where the interface is tracked across the mesh. This treatment is useful for a fluid problem since fluids are continuously deformable and tracking each fluid particle is not essential in computing fluid dynamics. For the solid this formulation is not very practical as the distance between particles are used to track the deformation, hence the particles need to be tracked. Tracking where the particles are, and consequentially the interface is, across meshpoints is a difficult task. One would need short spacing between meshpoints to accurately track the interface. In the second method (ALE) the interface moves with the mesh. 
The ALE formulation stands for Arbitrary Lagrangian Eulerian. This entails formulating the fluid equations in an Eulerian and the solid in a Lagrangian framework. The mesh itself moves with the structure and hence interface displacements, and the fluid moves through these points. In this way we get best of both world so to speak. The structure equation will remain as previously stated \eqref{eq:Solid}, and we will need to change the fluid equations to take into account the moving mesh changing the fluid velocity. This is done in two ways. One is to move the mesh itself in relation to the structural displacements, and calculate using this new mesh every time. 
This approach gives advantages as we can explicitly represent the fluid-structure interface, and the equations are stated in a more familiar manner. But problems arise when there are large deformations in the solid giving large deformations into the fluid domain. Moving the mesh with large deformation can be a challenge. 
In this thesis the ALE approach is used from a reference frame.
Meaning we solve the equation on a initial, stress free domain, and use a series of mappings to account for the movements of the domain. The equations are mapped to the current domain, that is where the domain has moved to in the present time. It is the displacement in the solid and the displacement extrapolated from the solid to the fluid domain that determines the mappings. 
From a technical point of view, both formulations are equivalent.\cite{Richter2016} But the ease of computing and time efficiency, in that we do not need an extra function to move the mesh between every timestep, contributes to the choice of using the mapped approached.
Lastly in this chapter we look at how to solve the equations. This problem is tackled using either a monolithic or a partitioned approach. We will go into details later, but the overall idea is that a monolithic scheme involves computing all the equations together into one block. The partitioned splits up into parts, that is we solve the fluid problem and structure problem separately. The advantage of this is that we can use existing solvers and techniques for each of the problems, but the difficulty is the treatment of the interface. The monolithic approach however, offers more stability but is more costly as the size of the problem increases\cite{Liu2014}.



\subsection*{Mapping}
Let $\hat{\mathcal{V}}$ be a reference volume and $\mathcal{V}(t)$ be the current time volume using \cite{Richter}. Then using \eqref{eq:deformation_gradient} and \eqref{eq:det_F} we define a mapping between the volumes from the current to reference configurations:

\begin{equation}
 \int_{\mathcal{V}(t)} 1  dx = \int_{\hat{\mathcal{V}}} J dx  
\end{equation}

The gradients acting on a vector $ \bold{u} $ will also be mapped between current and reference configurations:

\begin{equation}
\int_{\mathcal{V}(t)} \nabla \bold{u}   dx = \int_{\hat{\mathcal{V}}} J  \nabla \bold{u}F^{-1} dx  
\end{equation}

Same for the divergence of a vector $ \bold{u}$:

\begin{equation}
\int_{\mathcal{V}(t)} \nabla \cdot \bold{u}   dx = \int_{\hat{\mathcal{V}}} \nabla \cdot( J  F^{-1} \bold{u}) dx  
\end{equation}

\section*{Balance laws}

We will formulate the equations in the Eulerian, Lagrangian and the ALE description.

\subsection*{Solid}
We express the solid balance laws in the Lagrangian formulation from the initial configuration

\begin{equation}
\rho_s \frac{\partial^2 d}{\partial t^2} = \nabla \cdot (P) \hspace{4mm}in\hspace{4mm} \hat{\mathcal{S}} 
\end{equation}

\section*{Fluid}

The fluid domain is moving, and therefore we need to redefine the velocity in the convective term in \eqref{eq:NS} to account for the moving domain 
\begin{equation}
\bold{u} \cdot \nabla \bold{u} \rightarrow (\bold{u}-\frac{\partial d_f}{\partial t}) \cdot \nabla \bold{u}  
\end{equation}
where $d_f$ is the deformation in the fluid domain. Now the actual fluid velocity will be $u-\frac{\partial d}{\partial t}$ 

The fluid equations are denoted from the initial configuration using the aforementioned mappings:

\begin{align}
\int_{\mathcal{V}(t)} \rho_f \frac{\partial \bold{u}}{\partial t} dx & = \int_{\hat{\mathcal{V}}}  \rho_f J \frac{\partial \bold{u}}{\partial t} dx \\
\int_{\mathcal{V}(t)} \nabla \bold{u} (\bold{u}-\frac{\partial d}{\partial t}) dx  &= \int_{\hat{\mathcal{V}}} ((\nabla \bold{u})F^{-1}(\bold{u}-\frac{\partial d}{\partial t}) dx  \\
\int_{\mathcal{V}(t)} \nabla \cdot \bold{u} dx  &=\int_{\hat{\mathcal{V}}}  \nabla \cdot (J F^{-1} \bold{u}  ) dx \\
\int_{\mathcal{V}(t)} \nabla \cdot \sigma_f dx &= \int_{\hat{\mathcal{V}}} \nabla \cdot( J F^{-1} \hat{\sigma_f} )     dx \\
\hat{\sigma_f} &= -pI + \mu ( \nabla \bold{u} F^{-1} + F^{-T} \bold{u}^{T}  ) 
\end{align}

Putting this together \eqref{eq:NS} then turns into:

\begin{align}
\label{eq:NS_mapped}
\rho_f J \big( \frac{\partial \bold{u}}{\partial t} dx + (\nabla \bold{u})F^{-1}(\bold{u}-\frac{\partial d}{\partial t}) \big) &= \nabla \cdot( J F^{-1} \hat{\sigma_f} ) + J \rho_f f \\
\nabla \cdot (J F^{-1} \bold{u} ) &= 0
\end{align} 

\subsection*{Harmonic extension}
To bind together the computation of fluid and structure domain, we need an harmonic extension to the boundary values. The solid deformation $d$ is extended from the interface into the fluid domain and is done to help deal with big deformations in fluid domain. These big deformations can then cause several challenges to the ALE mapping. 
For this purpose define the following harmonic extension equation in the fluid domain:

\begin{equation}
 - \alpha_u \nabla^2 d^f = 0\hspace{4mm}in \hspace{2mm} \mathcal{\hat{F}}
\end{equation}

This equation is chosen for its good regularity and smoothing properties.
A strategy for choosing $\alpha_u$ is proposed by Wick in \cite{Wick2011}, and further discussed in \cite{Stein2003}. Where they set 
\begin{equation}
\label{eq:alpha_u}
\alpha_u = J^{-1}
\end{equation} 
This is a smart choice since J gets smaller closer to the interface, which again makes alpha large, this upholds the cell structure closer to the interface where most of the cell distortion appears.  
It is also possible to chose an harmonic extension with stiffening, which can give better control of the deformed meshes. This in practice behaves like a transport problem, transporting the deformation into the fluid domain. Another possibility is extension by pseudo-elasticity which defines the extension operator by means of the Navier-Lame equation. And lastly we can chose a biharmonic extension, 
\begin{equation}
- \alpha_u \nabla^4 d^f = 0
\end{equation}
this gives the freedom of not requiring a careful choice of mesh dependent parameter. Implementation of the biharmonic extension is more tedious in that we have to implement an extra function and extra boundary conditions.  It is also of fourth order character, and thus will have a high computational cost. \cite{Richter2016}


\subsection*{Coupled Fluid Structure Interface conditions}
We introduce a global domain $\Omega \in \mathcal{S} \cup \mathcal{F} $ that is made up of the fluid and the structure and the interface. We define a global velocity function $u$ that is the fluid velocity in the fluid domain and the structure velocity in the structure domain. This can be done due to the interface condition making the velocity field continuous over the entire domain. Then the interface will be $ \Gamma \in \mathcal{S} \cap \mathcal{F}  $  
We need to define conditions that couple that motions of the fluid and structure together. These consist of:

\begin{itemize}
\item Kinematic condition: $\bold{u}_f = \bold{u}_s  \hspace{4mm} on \Gamma$. The fluid and structure velocities need to be equal on the boundary. \\
We later realize this later by setting  $\bold{u}- \frac{\partial d}{\partial t}  = 0  $ on the solid domain to strongly imply that the velocity on the solid is the derivative of the deformation.  
\item Dynamic condition: $  \sigma_f n_f = \sigma_s n_s \hspace{4mm} on  \hspace{2mm}\Gamma   $. \\
	This relates to Newtons third law of action and reaction. The forces on the interface area, here written as the normal stresses are balanced on the interface. These will be written in a Lagrangian formulation: \\
	$J\sigma_f F^{-T} n_f = F\Sigma n_s \hspace{4mm} on  \hspace{2mm}\Gamma $. \\
	This condition is often added to structure problem, since it is most often in FSI problem the fluid exerting force that cause deformation.
\item Geometrical condition: This condition says that the fluid and structure domains do not overlap, but rather that elements connect so the functions needing to transfer force are continouos across the entire domain.
\end{itemize}

\section*{Monolithic FSI Problem}
As stated in the introduction there are generally two types of schemes used when simulating FSI. The partitioned approach where fluid and structure are solved sequentially, is appealing in that we have a wealth of knowledge and techniques on how to solve these kinds of problems in an efficient manner. The difficulty however is dealing with the interface. As we know there are kinematic and dynamic conditions needed in FSI, and the coupling of these conditions is where the problems arise. So called explicit coupled schemes are known to be unconditionally unstable for standard Dirichlet-Neumann strategies when there is a large amount of added-mass in the system \cite{Fernandez2015}, \cite{VanBrummelen2009}. There are schemes which offer added-mass free stability with explicit coupling, where the interface is treated through a Robin-Neumann coupling. First for a coupling with a thin walled structure \cite{Fernandez2013} and later an extension to thick wall \cite{Fernandez2015}. These schemes are rather complex and uses a number of techniques that are out of the scope of this thesis. ( This may be in more detail in a later chapter (discussion and further work.) ) \newline
The other is approach is monolithic, where all of the equations are solved at once. This approach has the advantage of offering numerical stability for problems with strong added-mass effects \cite{Liu2014}, and are fully coupled. The disadvantage over the partitioned approach is that we loose flexibility when solving many equations simultaneously, and the problems can quickly become very large and computationally costly. \newline
We start by stating the entire FSI ALE problem in a monolithic framework using the mapped approach: 



Find $\bold{u} \in \hat{\mathcal{F}} , p \in \hat{\mathcal{F}} \text{  and  } d \in \hat{\mathcal{S}} \text{  such that}:$ 
\begin{align}
\rho_f J \big( \frac{\partial u}{\partial t} + (\nabla \bold{u} )F^{-1}(\bold{u} -\frac{\partial d}{\partial t})\big)  + \nabla \cdot( J \hat{\sigma_f} F^{-T})  &= 0 \hspace{8mm}\text{on  } \hat{\mathcal{F}} \\
\nabla \cdot (J \bold{u}  F^{-T})\big) &= 0 \hspace{8mm} \text{on  } \hat{\mathcal{F}}   \\
\rho_s \frac{\partial \bold{u} }{\partial t} + \nabla \cdot F S_s,&=0 \hspace{8mm} \text{on  } \hat{\mathcal{S}}\\
\nabla^2 d &= 0 \hspace{8mm} \text{on  } \hat{\mathcal{F}}\\
\bold{u} - \frac{\partial d}{\partial t}  &= 0 \hspace{8mm} \text{on  } \hat{\mathcal{S}}\\
J\sigma_f F^{-T} n_f &= \sigma_s  n_s \hspace{3mm} \text{on  } \Gamma
\end{align}

\input{./Discretization/Discretization}




\section*{Finite Element method FSI in ALE}
\subsection*{Variational formulation}
\subsection*{Reference domain}
We use 3 testfunctions, $\phi, \psi, \gamma$. As mentioned before we use a global velocity function $u$ for both the solid and fluid.
\begin{align}
\rho_f J \big( \frac{\partial u}{\partial t} + (\nabla u)F^{-1}(u-\frac{\partial d}{\partial t}) , \phi\big)_{\mathcal{\hat{F}}} + (J\sigma_f F^{-T},\nabla \phi )_{\mathcal{\hat{F}}} &= 0  \\
 \big( \nabla \cdot (J u F^{-T}),\gamma \big)_{\mathcal{\hat{F}}} &= 0 \\
\big(\rho_s \frac{\partial u}{\partial t},\phi \big)_{\mathcal{\hat{S}}} + \big(F S_s, \nabla \phi \big)_{\mathcal{\hat{S}}} &=0 \\
 \big( \nabla d , \nabla \psi \big)_{\mathcal{\hat{F}}} &= 0 \\
 \big( u- \frac{\partial d}{\partial t} ,\psi \big)_{\mathcal{\hat{S}}} &= 0 
\end{align}
Equation (5) has not been addressed and is added since we use a global function for velocity we need to force that the structure velocity is the time derivative of the deformation in the structure domain. 

\subsection*{Spaces and Elements}
The velocity and pressure copling in the fluid domain must satisfy the inf-sup condition. If not stabilization has to added. We here need to define some spaces that will have these desired properties.
We denote $u_h \in V_h$ and $ d_h \in W_h $, here the finite element pair og pressure and velocity mush satisfy the inf-sup condition given in ALE coordinates:
$$   \inf_{\substack{p_h \in L_{h,f}}}  \sup_{\substack{v_h \in V_{h,f}}} \frac{ (p_h, div(J_f F_f^{-1} u_h))_{\mathcal{F}} }{ \|\|J^{\frac{1}{2}} p_h  \|\|_{\mathcal{F}} \|\|  J^{\frac{1}{2}}_{f} \nabla u_h F_f^{-T} \|\|_{\mathcal{F}}  } \geq \gamma     $$
A good choice of spaces will be P2-P2-P1 for velocity, displacement and fluid pressure respectively. 








