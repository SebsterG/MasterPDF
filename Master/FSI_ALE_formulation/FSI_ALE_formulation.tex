

\section*{Fluid Structure Interaction Problem in ALE}
The ALE formulation stands for Arbitrary Lagrangian Eulerian. This entails formulating the fluid equations in an Eulerian and the solid in a Lagrangian framework. This is as previously stated a very nice approach as it describes both fluid velocity and displacement in known configurations. The ALE method can be solved by moving the mesh for each time step following the structure body movements, and calculating on a "new" mesh every time. This approach gives advantages as we can explicitly represent the fluid-structure interface, but problems arise when there are large deformations in the solid giving large deformations to the fluid domain. We will therefore approach the ALE from a reference frame. That is we solve the equation on a initial, stress free domain, and use a series of mappings to account for the movements of the domain. From a technical point of view, both formulations are equivalent. But the ease of computing on fixed mesh does so that we chose fixed approach. \newline
Since the domain is moving with the structure movements, we will need to state the fluid in a little different.        

\subsection*{Notation}
$u$ - Velocity in fluid and structure. \\
$w$- Velocity in the domain. It is the velocity of the mesh in the calculations. This will also be the velocity in structure when defined in the Lagrangian formulation. \\
$d$ - Displacement of the solid. The time derivative of the displacement will be the domain velocity. \\
$p$ - Pressure in the fluid. \\
$\hat{\mathcal{S}}$ - Solid reference domain  \\
$\mathcal{S}$ - Solid current domain  \\
$ \hat{\mathcal{F}}$ - Fluid reference domain \\
$ \mathcal{F} $ - Fluid reference domain \\

Before we can state the full FSI problem we need to define the mappings to be used when computing from a reference frame.
\subsection*{Mapping}
Let $\hat{\mathcal{V}}$ be a reference volume and $\mathcal{V}(t)$ be the current time volume using [Godboka]. Then using the determinant of the deformation gradient $F = I+\nabla d $,  $J = det(F)$ we define a mapping between the volumes

$$  \int_{\mathcal{V}(t)} 1  dx = \int_{\hat{\mathcal{V}}} J dx  $$

The gradients acting on a vector $ \bold{u} $ will also be mapped between current and reference configurations

$$  \int_{\mathcal{V}(t)} \nabla \bold{u}   dx = \int_{\hat{\mathcal{V}}} J  \bold{u}F^{-1} dx  $$

\section*{Balance laws}
We will formulate the equations in the Eulerian, Lagrangian and the ALE description.

\subsection*{Solid}
We express the solid balance laws in the Lagrangian formulation from the initial configuration
$$\rho_s \frac{\partial^2 d}{\partial t^2} = \nabla \cdot (J \sigma_s F^{-T}) \hspace{4mm}in\hspace{4mm} \hat{\mathcal{S}} $$

\section*{Fluid}
The fluid domain is moving, and therefore we need to redefine the velocity in the convective term in N-S to account for the moving domain 

$$u \cdot \nabla u \rightarrow (u-\frac{\partial d_f}{\partial t}) \cdot \nabla u  $$ 
where $d_f$ is the deformation in the fluid domain. Now the actual fluid velocity will be $u-\frac{\partial d}{\partial t}$ 



The fluid particles are now moving on a moving domain $\nabla u (u-\frac{\partial d}{\partial t})$. So $u-\frac{\partial d}{\partial t}$ will be the actual fluid velocity.

The fluid equations are denoted from the initial configuration again following [godboka] using the forementioned mappings
\begin{align}
\int_{\mathcal{V}(t)} \rho_f \frac{\partial u}{\partial t} dx & = \int_{\hat{\mathcal{V}}}  \rho_f J \frac{\partial u}{\partial t} dx \\
\int_{\mathcal{V}(t)} \nabla u (u-\frac{\partial d}{\partial t}) dx  &= \int_{\hat{\mathcal{V}}} ((\nabla u)F^{-1}(u-\frac{\partial d}{\partial t}) dx  \\
\int_{\mathcal{V}(t)} \nabla \cdot u dx  &=\int_{\hat{\mathcal{V}}}  \nabla \cdot (J F^{-1} u  ) dx \\
\int_{\mathcal{V}(t)} \nabla \cdot \sigma_f dx &= \int_{\hat{\mathcal{V}}} \nabla \cdot( J F^{-1} \hat{\sigma_f} )     dx \\
\hat{\sigma_f} &= -pI + \mu ( \nabla u F^{-1} + F^{-T} u^{T}  ) 
\end{align}
 

\subsection*{Harmonic extension}
To bind together the computation of fluid and structure domain, we need a harmonic extension to the boundary values. The solid deformation $d$ is extended from the interface into the fluid domain and is done to help deal with big deformations in fluid domain. These big deformations can then cause several challenges to the ALE mapping. 
For this purpose define the following harmonic extension equation in the fluid domain:
$$ \nabla^2 d^f = 0\hspace{4mm}in \hspace{2mm} \mathcal{\hat{F}}$$ 
This equation is chosen for its good regularity and smoothing properties.

It is also possible to chose an harmonic extension with stiffening, which can give better control of the deformed meshes. This in practice behaves like a transport problem, transporting the deformation into the fluid domain. Another possibility is extension by pseudo-elasticity which defines the extension operator by means of the Navier-Lame equation. And lastly we can chose a biharmonic extension, that is of fourth order character, and thus will have a high computational cost. For now I will stick with the harmonic extension and maybe look at these in the future. [Godboka.]

\subsection*{Coupled Fluid Structure Interface conditions}
This section is based on 
We introduce a global domain $\Omega \in \mathcal{S} \cup \mathcal{F} $ that is made up of the fluid and the structure and the interface. We define a global velocity function $u$ that is the fluid velocity in the fluid domain and the structure velocity in the structure domain. This can be done due to the interface condition making the velocity field continuous over the entire domain. Then the interface will be $ \Gamma \in \mathcal{S} \cap \mathcal{F}  $  
We need to define conditions that couple that motions of the fluid and structure together. These consist of:
\begin{itemize}
\item Kinematic condition: $u_f = u_s  \hspace{4mm} on \Gamma$. The fluid and structure velocities need to be equal on the boundary. \\
We later realize this later by setting  $u- \frac{\partial d}{\partial t}  = 0  $ on the solid domain to strongly imply that the velocity on the solid is the derivative of the deformation.  
\item Dynamic condition: $  \sigma_f n_f = \sigma_s n_s \hspace{4mm} on  \hspace{2mm}\Gamma   $. \\
	This relates to Newtons third law of action and reaction. The forces on the interface area, here written as the normal stresses are balanced on the interface. These will be written in a Lagrangian formulation: \\
	$J\sigma_f F^{-T} n_f = F\Sigma n_s \hspace{4mm} on  \hspace{2mm}\Gamma $. \\
	This condition is often added to structure problem, since it is most often in FSI problem the fluid exerting force that cause deformation.
\item Geometrical condition: This condition says that the fluid and structure domains do not overlap, but rather that elements connect so the functions needing to transfer force are continouos across the entire domain.
\end{itemize}

\section*{ Full FSI Problem in reference domain}
Find $u \in \hat{\mathcal{F}} , p \in \hat{\mathcal{F}} \text{  and  } d \in \hat{\mathcal{S}} \text{  such that}:$ 
\begin{align}
\rho_f J \frac{\partial u}{\partial t} + (\nabla u)F^{-1}(u-\frac{\partial d}{\partial t})  + \nabla \cdot( J \hat{\sigma_f} F^{-T})  &= 0 \text{  on  } \hat{\mathcal{F}} \\
\nabla \cdot (J u F^{-T})\big) &= 0 \text{  on  } \hat{\mathcal{F}}   \\
\rho_s \frac{\partial u}{\partial t} + \nabla \cdot F S_s,&=0  \text{  on  } \hat{\mathcal{S}}\\
\nabla^2 d &= 0  \text{  on  } \hat{\mathcal{F}}\\
u- \frac{\partial d}{\partial t}  &= 0  \text{  on  } \hat{\mathcal{S}}\\
J\sigma_f F^{-T} n_f &= \sigma_s  n_s \text{  on  } \Gamma
\end{align}



\section*{Finite Element method FSI in ALE}
\subsection*{Variational formulation}
\subsection*{Reference domain}
We use 3 testfunctions, $\phi, \psi, \gamma$. As mentioned before we use a global velocity function $u$ for both the solid and fluid.
\begin{align}
\rho_f J \big( \frac{\partial u}{\partial t} + (\nabla u)F^{-1}(u-\frac{\partial d}{\partial t}) , \phi\big)_{\mathcal{\hat{F}}} + (J\sigma_f F^{-T},\nabla \phi )_{\mathcal{\hat{F}}} &= 0  \\
 \big( \nabla \cdot (J u F^{-T}),\gamma \big)_{\mathcal{\hat{F}}} &= 0 \\
\big(\rho_s \frac{\partial u}{\partial t},\phi \big)_{\mathcal{\hat{S}}} + \big(F S_s, \nabla \phi \big)_{\mathcal{\hat{S}}} &=0 \\
 \big( \nabla d , \nabla \psi \big)_{\mathcal{\hat{F}}} &= 0 \\
 \big( u- \frac{\partial d}{\partial t} ,\psi \big)_{\mathcal{\hat{S}}} &= 0 
\end{align}
Equation (5) has not been addressed and is added since we use a global function for velocity we need to force that the structure velocity is the time derivative of the deformation in the structure domain. 

\subsection*{Spaces and Elements}
The velocity and pressure copling in the fluid domain must satisfy the inf-sup condition. If not stabilization has to added. We here need to define some spaces that will have these desired properties.
We denote $u_h \in V_h$ and $ d_h \in W_h $, here the finite element pair og pressure and velocity mush satisfy the inf-sup condition given in ALE coordinates:
$$   \inf_{\substack{p_h \in L_{h,f}}}  \sup_{\substack{v_h \in V_{h,f}}} \frac{ (p_h, div(J_f F_f^{-1} u_h))_{\mathcal{F}} }{ \|\|J^{\frac{1}{2}} p_h  \|\|_{\mathcal{F}} \|\|  J^{\frac{1}{2}}_{f} \nabla u_h F_f^{-T} \|\|_{\mathcal{F}}  } \geq \gamma     $$
A good choice of spaces will be P2-P2-P1 for velocity, displacement and fluid pressure respectively. 








